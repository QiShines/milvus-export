name: Export Milvus v2.6.5

on:
  workflow_dispatch:

jobs:
  export:
    runs-on: ubuntu-latest
    steps:
      - name: Set up Docker with mirror
        run: |
          sudo mkdir -p /etc/docker
          echo '{"registry-mirrors":["https://hub-mirror.c.163.com"]}' | sudo tee /etc/docker/daemon.json
          sudo systemctl restart docker

      - name: Pull and Save
        run: |
          docker pull zilliz/milvus:v2.6.5
          docker save zilliz/milvus:v2.6.5 -o milvus_v2.6.5.tar

      - name: Upload
        uses: actions/upload-artifact@v4
        with:
          name: milvus-v2.6.5-tar
          path: milvus_v2.6.5.tar
